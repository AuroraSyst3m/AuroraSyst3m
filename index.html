<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸŒŒAuroraðŸŒŒ | Executive Terminal</title>
    <style>
        :root { --mint: #4ecca3; --blurple: #7289da; --bg: #050505; --red: #ff4d4d; --glass: rgba(255,255,255,0.03); }
        body { margin: 0; padding: 0; color: #fff; font-family: 'Segoe UI', sans-serif; background: var(--bg); overflow-x: hidden; }
        
        .aurora-bg { position: fixed; inset: 0; background: radial-gradient(circle at 20% 30%, rgba(78, 204, 163, 0.08), transparent), radial-gradient(circle at 80% 70%, rgba(114, 137, 218, 0.08), transparent); filter: blur(60px); z-index: -1; }

        /* Login Screen */
        .auth-overlay { position: fixed; inset: 0; background: var(--bg); display: flex; align-items: center; justify-content: center; z-index: 9999; }
        .auth-box { background: rgba(10, 10, 10, 0.9); padding: 50px; border-radius: 20px; border: 1px solid rgba(255, 255, 255, 0.1); text-align: center; width: 400px; backdrop-filter: blur(40px); box-shadow: 0 0 50px rgba(0,0,0,1); }
        .terminal-header { font-size: 10px; color: var(--mint); letter-spacing: 5px; margin-bottom: 20px; text-transform: uppercase; opacity: 0.8; }
        .auth-box h1 { letter-spacing: 15px; margin-bottom: 30px; font-weight: 200; text-shadow: 0 0 15px var(--mint); }
        .input-group input { width: 100%; padding: 15px; background: rgba(255,255,255,0.03); border: 1px solid #333; color: white; border-radius: 8px; text-align: center; margin-bottom: 20px; font-family: 'Courier New', monospace; outline: none; transition: 0.3s; }
        .input-group input:focus { border-color: var(--mint); }

        /* Navigation */
        nav { display: flex; justify-content: space-between; align-items: center; padding: 15px 5%; background: rgba(0,0,0,0.9); border-bottom: 1px solid rgba(255,255,255,0.1); position: sticky; top:0; z-index:100; }
        .nav-links a { color: #888; text-decoration: none; cursor: pointer; font-weight: bold; font-size: 12px; letter-spacing: 2px; margin-left: 25px; transition: 0.3s; text-transform: uppercase; }
        .nav-links a.active, .nav-links a:hover { color: var(--mint); text-shadow: 0 0 10px var(--mint); }

        /* Admin Command Center */
        #owner-panel { background: rgba(78, 204, 163, 0.03); border: 1px solid var(--mint); padding: 30px; border-radius: 15px; margin-bottom: 40px; display: none; }
        .admin-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px; }
        .admin-section { background: rgba(0,0,0,0.4); padding: 20px; border-radius: 10px; border: 1px solid rgba(255,255,255,0.05); }
        .log-table { width: 100%; font-size: 11px; text-align: left; border-collapse: collapse; font-family: monospace; }
        .log-table td { padding: 10px 5px; border-bottom: 1px solid #111; color: #ccc; }

        /* The Famous Blurple/Mint Animated Cards */
        .price-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 30px; margin-top: 30px; }
        .price-card { position: relative; background: #0a0a0a; padding: 2px; border-radius: 22px; overflow: hidden; display: flex; transition: 0.4s; min-height: 320px; }
        .price-card:hover { transform: translateY(-10px); box-shadow: 0 10px 30px rgba(78, 204, 163, 0.1); }
        .price-card::before { content: ''; position: absolute; width: 200%; height: 200%; background-image: conic-gradient(transparent, transparent, var(--mint), transparent, transparent, transparent, var(--blurple), transparent); animation: rotate 4s linear infinite; top: -50%; left: -50%; }
        .card-inner { background: #0a0a0a; padding: 25px; border-radius: 20px; width: 100%; position: relative; z-index: 5; display: flex; flex-direction: column; justify-content: space-between; }
        
        /* Buttons & Content */
        .btn-action { background: var(--mint); color: #000; border: none; padding: 14px; border-radius: 8px; font-weight: bold; cursor: pointer; width: 100%; transition: 0.3s; }
        .btn-action:hover { filter: brightness(1.2); transform: scale(1.02); }
        .price-row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.05); font-size: 14px; }
        
        #announcement-banner { background: var(--mint); color: #000; padding: 12px; text-align: center; font-weight: 900; display: none; letter-spacing: 2px; }
        .container { padding: 40px 10%; }
        .hidden { display: none; }
        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <div class="aurora-bg"></div>
    <div id="announcement-banner"></div>

    <div id="auth-screen" class="auth-overlay">
        <div class="auth-box" id="login-form">
            <div class="terminal-header">SECURE ACCESS v5.1</div>
            <h1>AURORA</h1>
            <div class="input-group">
                <input type="text" id="discord-user" placeholder="DISCORD_USERNAME">
            </div>
            <button class="btn-action" onclick="beginAuth()">INITIALIZE TERMINAL</button>
        </div>
        <div class="auth-box hidden" id="waiting-form">
            <div class="terminal-header" style="color:var(--mint)">AUTHORIZING...</div>
            <h2 style="letter-spacing: 3px;">VERIFYING</h2>
            <p style="color: #666; font-size: 13px;">Please check Discord DMs for the security handshake.</p>
        </div>
    </div>

    <div id="main-site" class="hidden">
        <nav>
            <h2 style="color: var(--mint); letter-spacing: 5px; margin:0;">AURORA</h2>
            <div class="nav-links">
                <a onclick="showTab('home')" id="nav-home" class="active">HOME</a>
                <a onclick="showTab('payments')" id="nav-payments">PAYMENTS</a>
                <a onclick="showTab('contact')" id="nav-contact">CONTACT</a>
                <a onclick="location.reload()" style="color:var(--red)">[LOGOUT]</a>
            </div>
        </nav>

        <div class="container">
            <div id="owner-panel">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <h2 style="margin:0; letter-spacing:2px; color: var(--mint);">ADMINISTRATOR OVERRIDE</h2>
                    <div>
                        <button class="btn-action" style="width:auto; padding:8px 15px; font-size:11px;" onclick="setMOTD()">SET ANNOUNCEMENT</button>
                        <button class="btn-action" style="width:auto; padding:8px 15px; font-size:11px; margin-left:10px;" onclick="openServiceModal()">ADD SERVICE</button>
                    </div>
                </div>
                
                <div class="admin-grid">
                    <div class="admin-section">
                        <h4 style="color:var(--mint); font-size:11px;">ACCESS LOGS</h4>
                        <table class="log-table"><tbody id="access-body"></tbody></table>
                    </div>
                    <div class="admin-section">
                        <h4 style="color:var(--mint); font-size:11px;">PURCHASE HISTORY</h4>
                        <table class="log-table"><tbody id="ledger-body"></tbody></table>
                    </div>
                </div>
            </div>

            <section id="tab-home">
                <h1>Welcome, <span id="user-display" style="color:var(--mint)">...</span></h1>
                <div style="background:var(--glass); padding:35px; border-radius:15px; border-left:5px solid var(--mint);">
                    <h3 style="margin-top:0;">System Integrity: Validated</h3>
                    <p style="color:#aaa;">You have successfully bypassed the encryption layer. Navigate to the <b>Payments</b> tab to view available service licenses.</p>
                </div>
            </section>

            <section id="tab-payments" class="hidden">
                <h1>Service <span style="color: var(--mint);">Licenses</span></h1>
                <div class="price-grid" id="service-grid"></div>
            </section>

            <section id="tab-contact" class="hidden">
                <h1>Secure <span style="color: var(--mint);">Contact</span></h1>
                <div style="background:var(--glass); padding:35px; border-radius:15px;">
                    <p><b>Official Discord:</b> .gg/aurora</p>
                    <p style="color:#666;">Response time: < 24 Hours</p>
                </div>
            </section>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <script>
        const OWNER_NAME = "frog360"; // RESTORED OWNER NAME

        const initialServices = [
            { name: "IXL (MATH)", color: "var(--mint)", prices: { Weekly: "$2.00", Monthly: "$3.50", Yearly: "$35.00" } },
            { name: "EP (MATH)", color: "var(--blurple)", prices: { Weekly: "$1.50", Monthly: "$4.50", Yearly: "$44.00" } },
            { name: "KAHOOT (MATH)", color: "var(--mint)", prices: { Weekly: "$3.50", Monthly: "$6.50", Yearly: "$65.00" } },
            { name: "BLOOKET (MATH)", color: "var(--blurple)", prices: { Weekly: "$2.00", Monthly: "$5.00", Yearly: "$50.00" } },
            { name: "ANYTHING AI", color: "var(--mint)", prices: { Weekly: "$2.00", Monthly: "$5.00", Yearly: "$50.00" } },
            { name: "AQUA AURORA", color: "var(--blurple)", prices: { Weekly: "$1.00", Monthly: "$3.00", Yearly: "$30.00" } },
            { name: "DONATION", color: "var(--mint)", prices: { Weekly: "$1.50", Monthly: "$4.00", Yearly: "$40.00" } },
            { name: "CUSTOM REQUEST", color: "var(--blurple)", prices: { Weekly: "$2.50", Monthly: "$6.00", Yearly: "$60.00" } },
            { name: "IXL (ENGLISH)", color: "var(--mint)", prices: { Weekly: "$1.80", Monthly: "$2.90", Yearly: "$30.00" } },
            { name: "EP (ENGLISH)", color: "var(--blurple)", prices: { Weekly: "$1.00", Monthly: "$4.00", Yearly: "$44.00" } },
            { name: "KAHOOT (ENGLISH)", color: "var(--mint)", prices: { Weekly: "$4.00", Monthly: "$8.00", Yearly: "$80.00" } },
            { name: "BLOOKET (ENGLISH)", color: "var(--blurple)", prices: { Weekly: "$3.00", Monthly: "$5.10", Yearly: "$59.99" } },
            { name: "VIDEO PLAYER", color: "var(--mint)", prices: { Weekly: "$?.??", Monthly: "$?.??", Yearly: "$?.??" } },
            { name: "PRIVATE ACCESS", color: "var(--blurple)", prices: { Weekly: "$?.??", Monthly: "$?.??", Yearly: "$?.??" } }
        ];

        const firebaseConfig = {
            apiKey: "AIzaSyCmnO3VTJ3KYg5x5dWOMLexT1_a9VPpP1Q",
            authDomain: "foldrex-aurora.firebaseapp.com",
            projectId: "foldrex-aurora",
            storageBucket: "foldrex-aurora.firebasestorage.app",
            messagingSenderId: "740976362878",
            appId: "1:740976362878:web:115653d38b717fd7171f2f"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        let loggedUser = "";

        async function beginAuth() {
            loggedUser = document.getElementById('discord-user').value.trim().toLowerCase();
            if(!loggedUser) return;
            const ip = await fetch('https://api.ipify.org?format=json').then(r => r.json()).then(d => d.ip).catch(() => "Unknown");
            
            const blackDoc = await db.collection("blacklist").doc(ip).get();
            if(blackDoc.exists) { alert("TERMINAL ACCESS DENIED"); return; }

            // frog360 Bypass
            if(loggedUser === OWNER_NAME.toLowerCase()) { unlockTerminal(); return; }

            document.getElementById('login-form').classList.add('hidden');
            document.getElementById('waiting-form').classList.remove('hidden');

            const reqRef = db.collection("auth_requests").doc(loggedUser);
            await reqRef.set({ username: loggedUser, status: "pending", ip_address: ip, timestamp: firebase.firestore.FieldValue.serverTimestamp() });
            reqRef.onSnapshot(doc => { if(doc.exists && doc.data().status === "approved") unlockTerminal(); });
        }

        function unlockTerminal() {
            document.getElementById('auth-screen').classList.add('hidden');
            document.getElementById('main-site').classList.remove('hidden');
            document.getElementById('user-display').innerText = loggedUser;
            
            db.collection("settings").doc("announcement").onSnapshot(doc => {
                if(doc.exists && doc.data().text) {
                    const b = document.getElementById('announcement-banner');
                    b.innerText = doc.data().text; b.style.display = 'block';
                }
            });

            if(loggedUser === OWNER_NAME.toLowerCase()) {
                document.getElementById('owner-panel').style.display = 'block';
                initAdminHub();
            }
            renderServices();
        }

        function initAdminHub() {
            db.collection("auth_requests").orderBy("timestamp", "desc").limit(8).onSnapshot(snap => {
                const b = document.getElementById('access-body'); b.innerHTML = "";
                snap.forEach(doc => {
                    const d = doc.data();
                    b.innerHTML += `<tr><td>${d.username}</td><td>${d.ip_address}</td><td>
                        <span style="color:var(--mint); cursor:pointer;" onclick="updateAccess('${doc.id}','approved')">[âœ”]</span>
                        <span style="color:var(--red); cursor:pointer; margin-left:10px;" onclick="banUser('${d.ip_address}')">[BAN]</span>
                    </td></tr>`;
                });
            });

            db.collection("purchases").orderBy("timestamp", "desc").limit(8).onSnapshot(snap => {
                const b = document.getElementById('ledger-body'); b.innerHTML = "";
                snap.forEach(doc => {
                    const d = doc.data();
                    b.innerHTML += `<tr><td>${d.user}</td><td>${d.service}</td><td>${d.timestamp ? d.timestamp.toDate().toLocaleTimeString() : '...'}</td></tr>`;
                });
            });
        }

        async function updateAccess(id, s) { await db.collection("auth_requests").doc(id).update({ status: s }); }
        async function banUser(ip) { if(confirm("Permanent Ban?")) await db.collection("blacklist").doc(ip).set({ bannedAt: firebase.firestore.FieldValue.serverTimestamp() }); }
        async function setMOTD() { const m = prompt("Announcement:"); await db.collection("settings").doc("announcement").set({ text: m }); }

        function renderServices() {
            const grid = document.getElementById('service-grid'); grid.innerHTML = "";
            initialServices.forEach(s => grid.appendChild(createCard(s)));
            db.collection("services").onSnapshot(snap => {
                document.querySelectorAll('.dyn-card').forEach(e => e.remove());
                snap.forEach(doc => {
                    const d = doc.data();
                    const c = createCard({ name: d.name, color: "var(--mint)", isDyn: true, id: doc.id, desc: d.desc, link: d.link });
                    c.classList.add('dyn-card'); grid.appendChild(c);
                });
            });
        }

        function createCard(s) {
            const div = document.createElement('div'); div.className = "price-card";
            let p = "";
            if(s.prices) { for (const [k, v] of Object.entries(s.prices)) p += `<div class="price-row"><span>${k}</span><span>${v}</span></div>`; }
            else p = `<p style="font-size:12px; color:#777;">${s.desc}</p>`;
            div.innerHTML = `<div class="card-inner"><div><h3 style="color:${s.color}">${s.name}</h3>${p}</div><button class="btn-action" style="background:${s.color}; margin-top:15px;" onclick="handlePurchase('${s.link || s.name}')">PURCHASE</button>
                ${s.isDyn && loggedUser === OWNER_NAME.toLowerCase() ? `<p onclick="delService('${s.id}')" style="color:var(--red); cursor:pointer; font-size:10px; text-align:center; margin-top:10px;">[DELETE]</p>` : ''}</div>`;
            return div;
        }

        function showTab(id) {
            ['home', 'payments', 'contact'].forEach(t => { document.getElementById('tab-'+t).classList.add('hidden'); document.getElementById('nav-'+t).classList.remove('active'); });
            document.getElementById('tab-'+id).classList.remove('hidden'); document.getElementById('nav-'+id).classList.add('active');
        }

        async function handlePurchase(n) {
            if(n.startsWith('http')) { window.open(n, '_blank'); return; }
            await db.collection("purchases").add({ user: loggedUser, service: n, timestamp: firebase.firestore.FieldValue.serverTimestamp() });
            alert("Order Logged.");
        }

        async function openServiceModal() {
            const n = prompt("Name:"); const d = prompt("Desc/Price:"); const l = prompt("Link:");
            if(n && d) await db.collection("services").add({ name: n, desc: d, link: l });
        }
        async function delService(id) { if(confirm("Delete?")) await db.collection("services").doc(id).delete(); }
    </script>
</body>
</html>
