<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸŒŒAuroraðŸŒŒ | Command Center</title>
    <style>
        :root { --mint: #4ecca3; --blurple: #7289da; --bg: #050505; --red: #ff4d4d; --glass: rgba(255,255,255,0.03); }
        body { margin: 0; padding: 0; color: #fff; font-family: 'Segoe UI', sans-serif; background: var(--bg); overflow-x: hidden; }
        
        .aurora-bg { position: fixed; inset: 0; background: radial-gradient(circle at 20% 30%, rgba(78, 204, 163, 0.08), transparent), radial-gradient(circle at 80% 70%, rgba(114, 137, 218, 0.08), transparent); filter: blur(60px); z-index: -1; }

        /* Login Screen */
        .auth-overlay { position: fixed; inset: 0; background: var(--bg); display: flex; align-items: center; justify-content: center; z-index: 9999; }
        .auth-box { background: rgba(10, 10, 10, 0.9); padding: 50px; border-radius: 10px; border: 1px solid rgba(78, 204, 163, 0.2); text-align: center; width: 400px; backdrop-filter: blur(40px); }
        .terminal-header { font-size: 10px; color: var(--mint); letter-spacing: 3px; margin-bottom: 20px; text-transform: uppercase; }
        .input-group input { width: 100%; padding: 15px; background: #111; border: 1px solid #333; color: white; border-radius: 4px; text-align: center; margin-bottom: 20px; font-family: monospace; }

        /* Navigation */
        nav { display: flex; justify-content: space-between; align-items: center; padding: 15px 5%; background: rgba(0,0,0,0.9); border-bottom: 1px solid rgba(255,255,255,0.1); sticky; top:0; z-index:100; }
        .nav-links a { color: #666; text-decoration: none; cursor: pointer; font-weight: bold; font-size: 11px; letter-spacing: 2px; margin-left: 20px; transition: 0.3s; }
        .nav-links a.active, .nav-links a:hover { color: var(--mint); }

        /* Admin Command Center */
        #owner-panel { background: #0a0a0a; border: 1px solid #222; padding: 30px; border-radius: 12px; margin-bottom: 40px; display: none; box-shadow: 0 10px 40px rgba(0,0,0,0.5); }
        .admin-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .admin-section { background: rgba(255,255,255,0.02); padding: 20px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.05); }
        .admin-section h4 { margin-top: 0; color: var(--mint); font-size: 12px; letter-spacing: 1px; border-bottom: 1px solid #222; padding-bottom: 10px; }

        .log-table { width: 100%; font-size: 10px; text-align: left; border-collapse: collapse; }
        .log-table th { color: #555; padding: 10px 5px; }
        .log-table td { padding: 8px 5px; border-bottom: 1px solid #111; }

        /* Action Buttons */
        .btn-mini { padding: 4px 8px; font-size: 9px; border-radius: 3px; cursor: pointer; border: none; font-weight: bold; }
        .btn-approve { background: var(--mint); color: #000; }
        .btn-deny { background: #333; color: #fff; margin-left: 5px; }
        .btn-ban { background: var(--red); color: #fff; margin-left: 5px; }
        .btn-action { background: var(--mint); color: #000; border: none; padding: 12px; border-radius: 4px; font-weight: bold; cursor: pointer; width: 100%; }

        /* UI Elements */
        .container { padding: 40px 10%; }
        .price-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 25px; margin-top: 20px; }
        .price-card { background: #0d0d0d; border: 1px solid #1a1a1a; padding: 25px; border-radius: 15px; position: relative; transition: 0.3s; }
        .price-card:hover { border-color: var(--mint); }
        .price-row { display: flex; justify-content: space-between; font-size: 13px; margin: 10px 0; border-bottom: 1px solid #151515; padding-bottom: 5px; }
        .hidden { display: none; }
    </style>
</head>
<body>

    <div class="aurora-bg"></div>

    <div id="auth-screen" class="auth-overlay">
        <div class="auth-box" id="login-form">
            <div class="terminal-header">AURORA COMMAND v4.5</div>
            <input type="text" id="discord-user" placeholder="USER_ID">
            <button class="btn-action" onclick="beginAuth()">LOGIN</button>
        </div>
        <div class="auth-box hidden" id="waiting-form">
            <div class="terminal-header" style="color:var(--mint)">ENCRYPTING SESSION...</div>
            <p style="font-size: 12px; color: #888;">Standby for Administrator Authorization.</p>
        </div>
    </div>

    <div id="main-site" class="hidden">
        <nav>
            <h2 style="color: var(--mint); margin:0;">AURORA</h2>
            <div class="nav-links">
                <a onclick="showTab('home')" id="nav-home" class="active">CORE</a>
                <a onclick="showTab('payments')" id="nav-payments">REGISTRY</a>
                <a onclick="showTab('contact')" id="nav-contact">SECURE</a>
                <a onclick="location.reload()" style="color:var(--red)">[EXIT]</a>
            </div>
        </nav>

        <div class="container">
            <div id="owner-panel">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                    <h2 style="margin:0; letter-spacing:3px;">COMMAND CENTER</h2>
                    <button class="btn-mini btn-approve" style="padding:10px;" onclick="openServiceModal()">+ ADD SERVICE</button>
                </div>
                
                <div class="admin-grid">
                    <div class="admin-section">
                        <h4>ACCESS CONTROL (LIVE)</h4>
                        <table class="log-table">
                            <thead><tr><th>USER</th><th>IP</th><th>ACTIONS</th></tr></thead>
                            <tbody id="access-body"></tbody>
                        </table>
                    </div>
                    <div class="admin-section">
                        <h4>PURCHASE LEDGER</h4>
                        
                        <table class="log-table">
                            <thead><tr><th>USER</th><th>ITEM</th><th>TIME</th></tr></thead>
                            <tbody id="ledger-body"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <section id="tab-home">
                <h1 style="font-weight:200;">Authorized: <span id="user-display" style="color:var(--mint)">...</span></h1>
                <div style="background:var(--glass); padding:30px; border-radius:10px; border-left:4px solid var(--mint);">
                    <h3 style="margin-top:0;">System Bulletin</h3>
                    <p style="color:#888;">Welcome to the Aurora v4.5 Secure Interface. Your session forensics are being logged for security purposes.</p>
                </div>
            </section>

            <section id="tab-payments" class="hidden">
                <h1>Service Registry</h1>
                <div class="price-grid" id="service-grid"></div>
            </section>

            <section id="tab-contact" class="hidden">
                <h1>Secure Contact</h1>
                <p>Reach out via Discord: .gg/aurora</p>
            </section>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <script>
        // --- 1. CONFIG (LINE 185) ---
        const OWNER_NAME = "YOUR_NAME_HERE"; 

        const initialServices = [
            { name: "IXL (MATH)", color: "var(--mint)", prices: { Weekly: "$2.00", Monthly: "$3.50", Yearly: "$35.00" } },
            { name: "EP (MATH)", color: "var(--blurple)", prices: { Weekly: "$1.50", Monthly: "$4.50", Yearly: "$44.00" } },
            { name: "KAHOOT (MATH)", color: "var(--mint)", prices: { Weekly: "$3.50", Monthly: "$6.50", Yearly: "$65.00" } },
            { name: "BLOOKET (MATH)", color: "var(--blurple)", prices: { Weekly: "$2.00", Monthly: "$5.00", Yearly: "$50.00" } },
            { name: "ANYTHING AI", color: "var(--mint)", prices: { Weekly: "$2.00", Monthly: "$5.00", Yearly: "$50.00" } },
            { name: "AQUA AURORA", color: "var(--blurple)", prices: { Weekly: "$1.00", Monthly: "$3.00", Yearly: "$30.00" } },
            { name: "DONATION", color: "var(--mint)", prices: { Weekly: "$1.50", Monthly: "$4.00", Yearly: "$40.00" } },
            { name: "CUSTOM REQUEST", color: "var(--blurple)", prices: { Weekly: "$2.50", Monthly: "$6.00", Yearly: "$60.00" } },
            { name: "IXL (ENGLISH)", color: "var(--mint)", prices: { Weekly: "$1.80", Monthly: "$2.90", Yearly: "$30.00" } },
            { name: "EP (ENGLISH)", color: "var(--blurple)", prices: { Weekly: "$1.00", Monthly: "$4.00", Yearly: "$44.00" } },
            { name: "KAHOOT (ENGLISH)", color: "var(--mint)", prices: { Weekly: "$4.00", Monthly: "$8.00", Yearly: "$80.00" } },
            { name: "BLOOKET (ENGLISH)", color: "var(--blurple)", prices: { Weekly: "$3.00", Monthly: "$5.10", Yearly: "$59.99" } },
            { name: "VIDEO PLAYER", color: "var(--mint)", prices: { Weekly: "$?.??", Monthly: "$?.??", Yearly: "$?.??" } },
            { name: "PRIVATE ACCESS", color: "var(--blurple)", prices: { Weekly: "$?.??", Monthly: "$?.??", Yearly: "$?.??" } }
        ];

        const firebaseConfig = {
            apiKey: "AIzaSyCmnO3VTJ3KYg5x5dWOMLexT1_a9VPpP1Q",
            authDomain: "foldrex-aurora.firebaseapp.com",
            projectId: "foldrex-aurora",
            storageBucket: "foldrex-aurora.firebasestorage.app",
            messagingSenderId: "740976362878",
            appId: "1:740976362878:web:115653d38b717fd7171f2f"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        let loggedUser = "";

        // --- AUTH ---
        async function beginAuth() {
            loggedUser = document.getElementById('discord-user').value.trim().toLowerCase();
            if(!loggedUser) return;

            const ip = await fetch('https://api.ipify.org?format=json').then(r => r.json()).then(d => d.ip).catch(() => "Unknown");
            
            // Blacklist Check
            const blackDoc = await db.collection("blacklist").doc(ip).get();
            if(blackDoc.exists) { alert("TERMINAL ACCESS DENIED: IP BLACKLISTED"); return; }

            document.getElementById('login-form').classList.add('hidden');
            document.getElementById('waiting-form').classList.remove('hidden');

            const reqRef = db.collection("auth_requests").doc(loggedUser);
            await reqRef.set({ username: loggedUser, status: "pending", ip_address: ip, timestamp: firebase.firestore.FieldValue.serverTimestamp() });

            reqRef.onSnapshot(doc => { if(doc.exists && doc.data().status === "approved") unlockTerminal(); });
        }

        function unlockTerminal() {
            document.getElementById('auth-screen').classList.add('hidden');
            document.getElementById('main-site').classList.remove('hidden');
            document.getElementById('user-display').innerText = loggedUser;
            if(loggedUser === OWNER_NAME.toLowerCase()) {
                document.getElementById('frog360').style.display = 'block';
                initAdminHub();
            }
            renderServices();
        }

        // --- ADMIN HUB LOGIC ---
        function initAdminHub() {
            // Access Log
            db.collection("auth_requests").orderBy("timestamp", "desc").limit(10).onSnapshot(snap => {
                const body = document.getElementById('access-body'); body.innerHTML = "";
                snap.forEach(doc => {
                    const d = doc.data();
                    body.innerHTML += `<tr><td>${d.username}</td><td>${d.ip_address}</td><td>
                        <button class="btn-mini btn-approve" onclick="updateAccess('${doc.id}','approved')">âœ”</button>
                        <button class="btn-mini btn-deny" onclick="updateAccess('${doc.id}','denied')">âœ–</button>
                        <button class="btn-mini btn-ban" onclick="banUser('${d.ip_address}')">BAN</button>
                    </td></tr>`;
                });
            });

            // Purchase Ledger
            db.collection("purchases").orderBy("timestamp", "desc").limit(10).onSnapshot(snap => {
                const body = document.getElementById('ledger-body'); body.innerHTML = "";
                snap.forEach(doc => {
                    const d = doc.data();
                    body.innerHTML += `<tr><td>${d.user}</td><td>${d.service}</td><td>${d.timestamp ? d.timestamp.toDate().toLocaleTimeString() : '...'}</td></tr>`;
                });
            });
        }

        async function updateAccess(id, status) { await db.collection("auth_requests").doc(id).update({ status }); }
        async function banUser(ip) { if(confirm("Permanent IP Ban?")) await db.collection("blacklist").doc(ip).set({ bannedAt: firebase.firestore.FieldValue.serverTimestamp() }); }

        // --- CORE UI ---
        function renderServices() {
            const grid = document.getElementById('service-grid'); grid.innerHTML = "";
            initialServices.forEach(s => grid.appendChild(createCard(s)));
            db.collection("services").onSnapshot(snap => {
                document.querySelectorAll('.dynamic').forEach(e => e.remove());
                snap.forEach(doc => {
                    const d = doc.data();
                    const c = createCard({ name: d.name, color: "var(--mint)", isDyn: true, id: doc.id, desc: d.desc, link: d.link });
                    c.classList.add('dynamic'); grid.appendChild(c);
                });
            });
        }

        function createCard(s) {
            const div = document.createElement('div'); div.className = "price-card";
            let p = "";
            if(s.prices) { for (const [k, v] of Object.entries(s.prices)) p += `<div class="price-row"><span>${k}</span><span>${v}</span></div>`; }
            else p = `<p style="font-size:12px; color:#666;">${s.desc}</p>`;
            div.innerHTML = `<h3>${s.name}</h3>${p}<button class="btn-action" style="background:${s.color}; margin-top:20px;" onclick="handlePurchase('${s.link || s.name}')">PURCHASE</button>
                ${s.isDyn && loggedUser === OWNER_NAME.toLowerCase() ? `<p onclick="delService('${s.id}')" style="color:red; cursor:pointer; font-size:10px; text-align:center;">[WIPE]</p>` : ''}`;
            return div;
        }

        function showTab(id) {
            ['home', 'payments', 'contact'].forEach(t => { document.getElementById('tab-'+t).classList.add('hidden'); document.getElementById('nav-'+t).classList.remove('active'); });
            document.getElementById('tab-'+id).classList.remove('hidden'); document.getElementById('nav-'+id).classList.add('active');
        }

        async function handlePurchase(n) {
            if(n.startsWith('http')) { window.open(n, '_blank'); return; }
            await db.collection("purchases").add({ user: loggedUser, service: n, timestamp: firebase.firestore.FieldValue.serverTimestamp() });
            alert("Order placed in ledger.");
        }

        async function openServiceModal() {
            const n = prompt("Name:"); const d = prompt("Price/Desc:"); const l = prompt("Link:");
            if(n && d) await db.collection("services").add({ name: n, desc: d, link: l });
        }
        async function delService(id) { if(confirm("Delete?")) await db.collection("services").doc(id).delete(); }
    </script>
</body>
</html>
